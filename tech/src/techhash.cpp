///////////////////////////////////////////////////////////////////////////////
// $Id$

#include "stdhdr.h"

#include "tech/techhash.h"

extern "C"
{
#include "md5.h"
}

#ifdef HAVE_UNITTESTPP
#include "UnitTest++.h"
#endif

#include "tech/dbgalloc.h" // must be last header


///////////////////////////////////////////////////////////////////////////////
//
// CLASS: cMD5
//

////////////////////////////////////////

cMD5::cMD5()
{
}

////////////////////////////////////////

void cMD5::Initialize()
{
   MD5Init((MD5_CTX *)&m_context[0]);
}

////////////////////////////////////////

void cMD5::Update(byte * pBytes, uint nBytes)
{
   MD5Update((MD5_CTX *)&m_context[0], pBytes, nBytes);
}

////////////////////////////////////////

void cMD5::Finalize(byte hash[16])
{
   MD5Final(hash, (MD5_CTX *)&m_context[0]);
}


///////////////////////////////////////////////////////////////////////////////
